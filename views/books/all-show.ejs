<!DOCTYPE html>
<html>

<head>
  <title>All Books</title>
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div class="container">

    <div class="main-content">
      <h1>Book Collection</h1>

      <% if (typeof msg !== 'undefined' && msg) { %>
      <div class="message message-success">
        <%= msg %>
      </div>
      <% } %>

      <div class="books-grid">
        <% if (typeof books !== 'undefined' && Array.isArray(books) && books.length > 0) { %>
        <% books.forEach(book => { %>
        <div class="book-card">
          <div class="book-cover">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
            </svg>
          </div>
          <h2 class="book-title">
            <%= book.title %>
          </h2>
          <p class="book-author">by <%= book.author %></p>

          <span class="book-status <%= book.status === 'Read' ? 'status-read' : 'status-want' %>">
            <%= book.status %>
          </span>

          <% if (book.rating) { %>
          <div class="book-rating">
            Rating: <%= book.rating %> ‚≠ê
          </div>
          <% } %>

          <div class="book-actions">
            <a href="/books/<%= book._id %>" class="btn-small btn-view">View</a>
            <% if (user && book.userId.toString() === user._id.toString()) { %>
            <a href="/books/<%= book._id %>/edit" class="btn-small btn-edit">Edit</a>
            <form action="/books/<%= book._id %>?_method=DELETE" method="POST" style="display:inline;">
              <button type="submit" class="btn-small btn-delete">Delete</button>
            </form>
            <% } %>
          </div>
        </div>
        <% }) %>
        <% } else { %>
        <div class="empty-state">
          <h2>No books found</h2>
          <p>Start building your collection by adding some books!</p>
        </div>
        <% } %>
      </div>

      <a href="/" class="btn-small" style="margin-top: 2rem; display: inline-block;">Back Home</a>
    </div>
  </div>
</body>

</html>